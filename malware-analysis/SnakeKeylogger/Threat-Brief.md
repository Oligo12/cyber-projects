# Threat Brief: SnakeKeylogger (aka 404 Keylogger)

**Source:** Public reporting + internal lab validation  
**Author:** Nikola MarkoviÄ‡  
**Scope:** Analyst-level threat intelligence brief

---

## Summary
SnakeKeylogger (also known as 404 Keylogger) is a widely distributed commodity credential-stealing malware targeting Microsoft Windows systems and commonly delivered via phishing campaigns.

While technically unsophisticated, SnakeKeylogger remains operationally impactful due to its use of phishing delivery, credential theft, and abuse of legitimate Windows functionality.

---

## Threat Status
- Actively observed in public malware repositories
- Multiple variants regularly uploaded to public malware repositories
- Commonly used as a Malware-as-a-Service (MaaS) offering 

---

## Affected Platforms
- Microsoft Windows endpoints
- End users targeted via phishing emails and malicious attachments

---

## Common Capabilities
- Keystroke logging
- Clipboard monitoring
- Browser credential theft
- Email client credential extraction (e.g., Outlook, Thunderbird, Foxmail)
- Basic system profiling
- File and data exfiltration

---

## Exfiltration Methods
Variant-dependent exfiltration channels, including:
- SMTP (email-based exfiltration)
- Telegram bots
- FTP or Pastebin (reported in some variants)

---

## Delivery & Execution
- Commonly delivered via phishing emails containing malicious attachments
- Public reporting describes multiple loader implementations, including AutoIt, VBS, and PowerShell
- The analyzed lab sample used a PowerShell-based loader to execute a .NET payload in memory
- Some variants inject into legitimate Windows processes to evade detection

---

## Persistence
- Registry Run key persistence observed across multiple public samples
- Some variants rely on watchdog or respawn loops without durable persistence
- Persistence was not observed in the analyzed lab sample

---

## Detection & Defensive Actions
- Enable and monitor PowerShell Script Block Logging (Event ID 4104)
- Detect suspicious PowerShell obfuscation and in-memory execution
- Monitor registry Run key modifications
- Monitor for suspicious process injection or hollowing behaviors involving legitimate Windows binaries
- Review outbound SMTP traffic for anomalous behavior
- Enforce email attachment filtering and user awareness controls

---

## Notes
This threat brief is based on public vendor reporting combined with behaviors validated in an internal Microsoft Sentinel lab.  
Detailed malware analysis, detections, and incident response workflows are documented separately.  

The purpose of this document is to demonstrate how public threat intelligence can be translated into practical detection and defensive guidance.

---

## Related Internal Work (Lab)
- Malware analysis report: [Report.md](SnakeKeylogger/Report.md)
- Detections (KQL): [PS in-memory loader](../../detection-lab/detections/kql/powerShell_in-memory_loader_behavior.md) & [Delayed respawn loop](../../detection-lab/detections/kql/delayed_command_execution_respawn_loop.md)
- Incident response timeline: [SnakeKeylogger IR timeline](../../incident-response/snakekeylogger-sentinel-timeline.md)

